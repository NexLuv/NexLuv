<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Girly Transformation Tracker</title>
    <style>
        /* Basic body styling */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(to right, #f9a8d4, #e9d5ff); /* Pink to lavender gradient */
            min-height: 100vh; /* Ensure background covers full height */
        }
        /* Main container styling */
        .container {
            max-width: 800px;
            margin: 20px auto; /* Center the container with margin */
            background: white;
            border-radius: 12px; /* Rounded corners */
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); /* Subtle shadow */
            overflow: hidden; /* Keep content within rounded corners */
        }
        /* Header styling */
        .header {
            background: linear-gradient(to right, #ec4899, #a855f7); /* Pink to purple gradient */
            color: white;
            padding: 20px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 24px;
        }
        .today-info {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 5px;
        }
        .recommendation {
            background-color: rgba(255, 255, 255, 0.2); /* Semi-transparent white */
            padding: 8px;
            border-radius: 8px;
            margin-top: 8px;
            font-size: 14px;
        }
        /* Main section tabs */
        .main-tabs {
            display: flex;
            border-bottom: 1px solid #e5e7eb; /* Light gray border */
        }
        .main-tab {
            flex: 1; /* Equal width */
            padding: 15px;
            text-align: center;
            cursor: pointer;
            font-weight: bold;
            background: white;
            color: #9ca3af; /* Gray text */
            transition: background-color 0.2s, color 0.2s; /* Smooth transition */
        }
        .main-tab.active {
            background: #fdf2f8; /* Light pink background */
            color: #be185d; /* Dark pink text */
            border-bottom: 3px solid #be185d; /* Pink underline */
        }
        /* Specific active style for Meals tab */
         .main-tab#meals-main-tab.active {
            background: #fffbeb; /* Light orange background */
            color: #b45309; /* Dark orange text */
            border-bottom-color: #f59e0b; /* Orange underline */
        }
        /* Skincare routine tabs (Morning/Evening) */
        .tabs {
            display: flex;
            border-bottom: 1px solid #e5e7eb;
        }
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s, color 0.2s;
        }
        .tab.active-morning {
            background-color: #fef3c7; /* Light yellow */
            color: #b45309; /* Dark yellow/brown */
        }
        .tab.inactive {
            background-color: white;
            color: #9ca3af; /* Gray text */
        }
        .tab.active-evening {
            background-color: #e0e7ff; /* Light blue */
            color: #4f46e5; /* Dark blue/purple */
        }
        /* Day tabs (for Workout and Meals) */
        .day-tabs {
            display: flex;
            flex-wrap: wrap; /* Allow tabs to wrap on smaller screens */
            border-bottom: 1px solid #e5e7eb;
        }
        .day-tab {
            flex-basis: 14.28%; /* Roughly 1/7th width */
            flex-grow: 1; /* Allow tabs to grow to fill space */
            padding: 10px 5px;
            text-align: center;
            cursor: pointer;
            font-weight: bold;
            font-size: 12px;
            background-color: white;
            color: #9ca3af;
            transition: background-color 0.2s, color 0.2s;
        }
        .day-tab.active.workout-active {
            background-color: #ede9fe; /* Light purple */
            color: #6d28d9; /* Dark purple */
            border-bottom: 3px solid #6d28d9; /* Purple underline */
        }
        .day-tab.active.meals-active {
            background-color: #fff7ed; /* Light orange */
            color: #9a3412; /* Dark orange */
            border-bottom: 3px solid #f97316; /* Orange underline */
        }
        /* Routine content styling */
        .routine {
            padding: 20px;
        }
        .routine-title {
            font-size: 20px;
            margin-bottom: 5px; /* Reduced margin */
            color: #6d28d9; /* Dark purple */
        }
        /* Routine Purpose Styling */
        .routine-purpose {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 15px;
            background-color: #f9fafb;
            padding: 10px;
            border-radius: 6px;
            border-left: 3px solid #a855f7; /* Purple accent */
        }
        /* Evening treatment buttons */
        .treatment-buttons {
            display: flex;
            gap: 10px; /* Space between buttons */
            margin-bottom: 10px;
        }
        .treatment-btn {
            flex: 1;
            padding: 10px;
            border: 1px solid #a78bfa; /* Light purple border */
            border-radius: 20px; /* Pill shape */
            background: white;
            color: #7c3aed; /* Purple text */
            cursor: pointer;
            text-align: center;
            transition: background-color 0.2s, color 0.2s;
        }
        .treatment-btn.active {
            background: #8b5cf6; /* Medium purple background */
            color: white;
        }
        /* Schedule info styling */
        .schedule-info {
            font-size: 13px;
            color: #6b7280; /* Medium gray */
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap; /* Allow wrapping */
            gap: 10px;
        }
        .schedule-item {
            padding: 6px 10px;
            border-radius: 15px; /* Rounded pill shape */
            background-color: #f3f4f6; /* Light gray background */
        }
        .schedule-item.highlighted {
            background-color: #dbeafe; /* Light blue background */
            font-weight: bold;
        }
        /* Step styling (for skincare, workout items, meal items) */
        .step {
            background-color: #f5f3ff; /* Very light purple */
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
        }
        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .step-checkbox {
            width: 20px;
            height: 20px;
            border: 1px solid #d1d5db; /* Light gray border */
            border-radius: 4px;
            margin-right: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white; /* Checkmark color */
            transition: background-color 0.2s, border-color 0.2s;
            flex-shrink: 0; /* Prevent checkbox from shrinking */
        }
        .step-checkbox.checked {
            background-color: #22c55e; /* Green background when checked */
            border-color: #22c55e; /* Green border */
        }
        .step-title {
            font-weight: bold;
            flex-grow: 1; /* Allow title to take available space */
        }
        .step-time {
            font-size: 12px;
            color: #6b7280;
            margin-left: 10px;
            white-space: nowrap; /* Prevent time from wrapping */
        }
        /* Product details styling */
        .product-details {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 8px; /* Increased margin */
            padding-left: 30px; /* Indent details under checkbox */
        }
        .product-name {
            color: #111827; /* Dark gray/black */
        }
        /* Summary Checklist Styling */
        .summary-checklist {
            margin-top: 20px;
            padding: 15px;
            background-color: #eef2ff; /* Light indigo background */
            border-radius: 8px;
            border-left: 3px solid #4f46e5; /* Indigo accent */
        }
        .summary-checklist h4 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #3730a3; /* Darker indigo */
            font-size: 15px;
        }
        .summary-checklist p {
            margin: 3px 0;
            font-size: 14px;
            color: #4338ca; /* Medium indigo */
        }

        /* Progress bar section */
        .progress-section {
            padding: 15px 20px;
            border-bottom: 1px solid #e5e7eb;
        }
        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 14px;
            color: #6b7280;
        }
        .progress-bar-container {
            height: 10px;
            background-color: #e5e7eb; /* Gray background */
            border-radius: 5px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, #ec4899, #a855f7); /* Pink to purple gradient */
            transition: width 0.3s ease-in-out; /* Smooth width transition */
            width: 0%; /* Initial width */
        }
        /* Workout section specific styling */
        .workout-section, .meal-section {
            padding: 15px;
        }
        .workout-time-title, .meal-time-title {
            font-weight: bold;
            color: #4b5563; /* Darker gray */
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            font-size: 16px;
        }
        .workout-time-title::before { content: "⏰"; margin-right: 8px; font-size: 18px; }
        .evening-workout-container > .workout-time-title::before { content: "🌙"; }

        /* Meal Section Specifics */
        .meal-block { background-color: #f3f4f6; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
        .meal-block .step { background-color: #fff; } /* Make meal items have white background */
        .meal-time-title::before { content: "🍴"; margin-right: 8px; font-size: 18px; }

        /* Utility class to hide elements */
        .hidden { display: none !important; }
        /* Notice text at the bottom */
        .notice {
            text-align: center;
            font-size: 12px;
            color: #6b7280;
            padding: 10px;
            background-color: #f9fafb; /* Very light gray */
            border-top: 1px solid #e5e7eb;
        }
        /* Heart emoji styling */
        .heart { color: #ec4899; }
        /* Active/inactive content sections */
        .section-content, .day-content { display: none; }
        .section-content.active, .day-content.active { display: block; }

        /* Objective box styling */
        .objective {
            background-color: #fef3c7;
            padding: 10px 15px;
            margin: 0 15px 15px 15px;
            border-radius: 5px;
            font-size: 14px;
            border: 1px solid #fde68a;
        }
        /* Workout Location Toggle Styles */
        .location-toggle { display: flex; gap: 8px; margin-bottom: 15px; margin-top: -5px; }
        .toggle-option {
            flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 15px;
            background: #e5e7eb; color: #4b5563; cursor: pointer; text-align: center;
            font-size: 13px; font-weight: bold; transition: all 0.2s;
        }
        .toggle-option.active { background: #8b5cf6; color: white; border-color: #7c3aed; }
        /* Workout Exercise Blocks Styles */
        .exercise-block { padding-top: 10px; border-top: 1px dashed #d1d5db; margin-top: 10px; }
        .exercise-block.hidden { display: none; }
        .exercise-block.active { display: block; }
         /* --- History Section Styles --- */
         #history-toggle-section { text-align: center; padding: 15px; border-top: 1px solid #e5e7eb; background-color: #f9fafb; }
         .history-btn { padding: 8px 16px; border: 1px solid #6b7280; border-radius: 20px; background-color: white; color: #4b5563; cursor: pointer; font-weight: bold; transition: all 0.2s; margin-left: 10px; }
         .history-btn:hover { background-color: #f3f4f6; }
         #history-display-section { padding: 20px; background-color: #f9fafb; border-top: 1px dashed #e5e7eb; }
         #history-display-section h3 { text-align: center; color: #4b5563; margin-top: 0; margin-bottom: 15px; }
         #history-date-input { padding: 6px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; }
         .history-summary-section { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #e5e7eb; }
         .history-summary-section:last-child { border-bottom: none; margin-bottom: 0; }
         .history-summary-title { font-weight: bold; color: #374151; margin-bottom: 5px; }
         .history-summary-details { font-size: 14px; color: #4b5563; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>✨ Girly Transformation Tracker ✨</h1>
            <p class="today-info" id="current-date">Loading date...</p>
            <div class="recommendation" id="today-recommendation">Loading recommendation...</div>
        </div>

        <div class="main-tabs">
            <div id="skincare-main-tab" class="main-tab active">💧 Skincare</div>
            <div id="workout-main-tab" class="main-tab">💪 Workout</div>
            <div id="meals-main-tab" class="main-tab">🍱 Meals</div>
        </div>

        <div id="main-progress-section" class="progress-section">
            <div class="progress-header">
                <span>Daily Task Progress</span>
                <span id="progress-percentage">0%</span>
            </div>
            <div class="progress-bar-container">
                <div id="progress-bar" class="progress-bar"></div>
            </div>
        </div>

        <div id="skincare-section" class="section-content active">
             <div class="tabs">
                 <div id="morning-tab" class="tab active-morning">☀️ Morning Routine</div>
                 <div id="evening-tab" class="tab inactive">🌙 Evening Routine</div>
             </div>
             <div id="morning-routine" class="routine">
                 <h2 class="routine-title">✨ MORNING SKINCARE ROUTINE</h2>
                 <div class="routine-purpose"><strong>Goal:</strong> Clean skin, antioxidant protection, hydration, and sun protection (Total time: ~6 minutes)</div>
                 <div class="step"><div class="step-header"><div id="morning-cleanse" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1. Cleanse</div><div class="step-time">⏱️ 2 min</div></div><div class="product-details"><div class="product-name"><span class="heart">💖</span> CeraVe Foaming Facial Cleanser</div></div></div>
                 <div class="step"><div class="step-header"><div id="morning-vitaminc" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">2. Vitamin C Serum</div><div class="step-time">⏱️ 1 min</div></div><div class="product-details"><div class="product-name"><span class="heart">💖</span> TruSkin Vitamin C Serum</div></div></div>
                 <div class="step"><div class="step-header"><div id="morning-moisturize" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">3. Moisturize</div><div class="step-time">⏱️ 1 min</div></div><div class="product-details"><div class="product-name"><span class="heart">💖</span> CeraVe Daily Moisturizing Lotion</div></div></div>
                 <div class="step"><div class="step-header"><div id="morning-sunscreen" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">4. Sunscreen</div><div class="step-time">⏱️ 1 min</div></div><div class="product-details"><div class="product-name"><span class="heart">💖</span> La Roche-Posay Anthelios Clear Skin SPF 60</div></div></div>
             </div>
             <div id="evening-routine" class="routine hidden">
                 <h2 class="routine-title">🌙 EVENING SKINCARE ROUTINE</h2>
                 <div class="routine-purpose"><strong>Goal:</strong> Clean skin, apply actives, hydrate, lock in moisture (Total time: 7–10 minutes)</div>
                 <div class="treatment-buttons"><div id="retinoid-btn" class="treatment-btn">Retinoid</div><div id="exfoliant-btn" class="treatment-btn">Exfoliant</div><div id="slugging-btn" class="treatment-btn">Slugging</div></div>
                 <div class="schedule-info"><div id="retinoid-schedule" class="schedule-item">Retinoid: Mon, Wed, Fri</div><div id="exfoliant-schedule" class="schedule-item">Exfoliant: Tue, Thu</div><div id="slugging-schedule" class="schedule-item">Slugging: Sat, Sun</div></div>
                 <div class="step"><div class="step-header"><div id="evening-cleanse" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1. Cleanse</div><div class="step-time">⏱️ 2 min</div></div><div class="product-details"><div class="product-name"><span class="heart">💖</span> CeraVe Foaming Facial Cleanser</div></div></div>
                 <div id="retinoid-step" class="step hidden"><div class="step-header"><div id="evening-treatment-retinoid" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">2. Treatment (Retinoid)</div><div class="step-time">⏱️ 2-3 min</div></div><div class="product-details"><div class="product-name"><span class="heart">💖</span> DiJerin Adapalene Gel (0.1%)</div></div></div>
                 <div id="exfoliant-step" class="step hidden"><div class="step-header"><div id="evening-treatment-exfoliant" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">2. Treatment (Exfoliant)</div><div class="step-time">⏱️ 2 min</div></div><div class="product-details"><div class="product-name"><span class="heart">💖</span> The Ordinary Glycolic Acid 7% Toner</div></div></div>
                 <div id="slugging-step" class="step hidden"><div class="step-header"><div id="evening-treatment-slugging" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">2. Treatment (Slugging Night)</div><div class="step-time">⏱️ 1 min</div></div><div class="product-details"><div class="product-name"><span class="heart">💖</span> No actives tonight</div></div></div>
                 <div class="step"><div class="step-header"><div id="evening-hydration" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">3. Hydration</div><div class="step-time">⏱️ 1-2 min</div></div><div class="product-details"><div class="product-name"><span class="heart">💖</span> The Ordinary Hyaluronic Acid 2% + B5</div></div></div>
                 <div class="step"><div class="step-header"><div id="evening-moisturize" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">4. Moisturize</div><div class="step-time">⏱️ 2 min</div></div><div class="product-details"><div class="product-name"><span class="heart">💖</span> CeraVe PM Moisturizing Lotion</div></div></div>
                 <div id="evening-slug" class="step hidden"><div class="step-header"><div id="evening-slugging" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">5. Slugging Final Step</div><div class="step-time">⏱️ 2 min</div></div><div class="product-details"><div class="product-name"><span class="heart">💖</span> Vaseline + Silk/Satin Sleep Mask</div></div></div>
             </div>
        </div>

        <div id="workout-section" class="section-content">
             <div class="day-tabs">
                  <div id="monday-workout-tab" class="day-tab workout-active">Mon</div>
                  <div id="tuesday-workout-tab" class="day-tab workout-active">Tue</div>
                  <div id="wednesday-workout-tab" class="day-tab workout-active">Wed</div>
                  <div id="thursday-workout-tab" class="day-tab workout-active">Thu</div>
                  <div id="friday-workout-tab" class="day-tab workout-active">Fri</div>
                  <div id="saturday-workout-tab" class="day-tab workout-active">Sat</div>
                  <div id="sunday-workout-tab" class="day-tab workout-active">Sun</div>
             </div>
             <div class="objective"> <strong>Workout Plan Objective:</strong> Maximize lower body hypertrophy and induce upper body atrophy while prioritizing fat loss.</div>
             
             <div id="monday-workout" class="day-content workout">
                 <div class="workout-section"><h2 class="routine-title">Monday – Heavy Lifting (Workout A)</h2><div class="workout-time evening-workout-container"><div class="workout-time-title">Main Gym Session</div><div class="location-toggle"><div id="monday-toggle-gym" class="toggle-option">📍 Gym</div><div id="monday-toggle-home" class="toggle-option">🏠 Home</div></div><div id="monday-gym-exercises" class="exercise-block"><div class="step"><div class="step-header"><div id="mon-gym-1" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Barbell Back Squat: 4 sets of 8-12 reps (2 RIR)</div></div></div><div class="step"><div class="step-header"><div id="mon-gym-2" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Romanian Deadlift: 3 sets of 10-15 reps (2 RIR)</div></div></div><div class="step"><div class="step-header"><div id="mon-gym-3" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Leg Press: 3 sets of 10-15 reps (1 RIR)</div></div></div><div class="step"><div class="step-header"><div id="mon-gym-4" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Walking Lunges: 3 sets of 12-15 reps/leg (2 RIR)</div></div></div><div class="step"><div class="step-header"><div id="mon-gym-5" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Seated Leg Curls: 3 sets of 15-20 reps (0 RIR)</div></div></div><div class="step"><div class="step-header"><div id="mon-gym-6" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Standing Calf Raises: 4 sets of 15-20 reps (0 RIR)</div></div></div></div><div id="monday-home-exercises" class="exercise-block hidden"><div class="step"><div class="step-header"><div id="mon-home-1" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Dumbbell Goblet Squats: 4 sets of 10-15 reps</div></div></div></div></div></div>
             </div>
             <div id="tuesday-workout" class="day-content workout">
                 <div class="workout-section"><h2 class="routine-title">Tuesday – Cardio & Corrective</h2><div class="workout-time"><div class="workout-time-title">LISS Cardio & Mandatory Corrective Routine</div><div class="step"><div class="step-header"><div id="tue-1" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">LISS Cardio: 30-45 min (Incline Walk / Elliptical)</div></div></div><div class="step"><div class="step-header"><div id="tue-2" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Core: Plank - 3 sets of 30-60 sec holds</div></div></div><div class="step"><div class="step-header"><div id="tue-3" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Core: Dead Bug - 3 sets of 45-60 sec</div></div></div><div class="step"><div class="step-header"><div id="tue-4" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Scapular Health: Band Pull-Aparts - 3 sets of 15-20 reps</div></div></div><div class="step"><div class="step-header"><div id="tue-5" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Scapular Health: Face Pulls (light band) - 3 sets of 15-20 reps</div></div></div><div class="step"><div class="step-header"><div id="tue-6" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Mobility: Wall Slides - 3 sets of 10-15 reps</div></div></div></div></div>
             </div>
             <div id="wednesday-workout" class="day-content workout">
                 <div class="workout-section"><h2 class="routine-title">Wednesday – Heavy Lifting (Workout B)</h2><div class="workout-time evening-workout-container"><div class="workout-time-title">Main Gym Session</div><div class="location-toggle"><div id="wednesday-toggle-gym" class="toggle-option">📍 Gym</div><div id="wednesday-toggle-home" class="toggle-option">🏠 Home</div></div><div id="wednesday-gym-exercises" class="exercise-block"><div class="step"><div class="step-header"><div id="wed-gym-1" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Barbell Hip Thrust: 4 sets of 8-12 reps (2 RIR)</div></div></div><div class="step"><div class="step-header"><div id="wed-gym-2" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Bulgarian Split Squat: 3 sets of 10-15 reps/leg (1 RIR)</div></div></div></div></div></div>
             </div>
             <div id="thursday-workout" class="day-content workout">
                 <div class="workout-section"><h2 class="routine-title">Thursday – Cardio & Corrective</h2><div class="workout-time"><div class="workout-time-title">LISS Cardio & Mandatory Corrective Routine</div><div class="step"><div class="step-header"><div id="thu-1" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">LISS Cardio: 30-45 min (Incline Walk / Elliptical)</div></div></div><div class="step"><div class="step-header"><div id="thu-2" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Core: Side Plank - 3 sets of 30-45 sec holds/side</div></div></div></div></div>
             </div>
             <div id="friday-workout" class="day-content workout">
                 <div class="workout-section"><h2 class="routine-title">Friday – Heavy Lifting (Workout C)</h2><div class="workout-time evening-workout-container"><div class="workout-time-title">Main Gym Session</div><div class="location-toggle"><div id="friday-toggle-gym" class="toggle-option">📍 Gym</div><div id="friday-toggle-home" class="toggle-option">🏠 Home</div></div><div id="friday-gym-exercises" class="exercise-block"><div class="step"><div class="step-header"><div id="fri-gym-1" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Leg Extensions (Pre-exhaust): 3 sets of 20-30 reps (0 RIR)</div></div></div><div class="step"><div class="step-header"><div id="fri-gym-2" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Goblet Squat (Heels Elevated): 4 sets of 15-20 reps (1 RIR)</div></div></div></div></div></div>
             </div>
             <div id="saturday-workout" class="day-content workout">
                 <div class="workout-section"><h2 class="routine-title">Saturday – Active Recovery</h2><div class="workout-time"><div class="workout-time-title">Optional Light Activity</div><div class="step"><div class="step-header"><div id="sat-1" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">LISS Cardio / Light Walk: 30-45 min</div></div></div></div></div>
             </div>
             <div id="sunday-workout" class="day-content workout">
                 <div class="workout-section"><h2 class="routine-title">Sunday – Full Rest & Prep</h2><div class="workout-time"><div class="workout-time-title">Primary Mission: Recovery</div><div class="step"><div class="step-header"><div id="sun-1" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Complete Rest Day</div></div></div><div class="step"><div class="step-header"><div id="sun-2" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Meal Prep for the Upcoming Week</div></div></div></div></div>
             </div>
        </div>
        
        <div id="meals-section" class="section-content">
            <div class="day-tabs">
                <div id="monday-meals-tab" class="day-tab meals-active">Mon</div>
                <div id="tuesday-meals-tab" class="day-tab meals-active">Tue</div>
                <div id="wednesday-meals-tab" class="day-tab meals-active">Wed</div>
                <div id="thursday-meals-tab" class="day-tab meals-active">Thu</div>
                <div id="friday-meals-tab" class="day-tab meals-active">Fri</div>
                <div id="saturday-meals-tab" class="day-tab meals-active">Sat</div>
                <div id="sunday-meals-tab" class="day-tab meals-active">Sun</div>
            </div>
            <div class="objective"><strong>Nutritional Objective:</strong> High Protein, Carb Cycling to fuel workouts and maximize fat loss.</div>
            
            <div id="monday-meals" class="day-content meals">
                <div class="meal-section"><h2 class="routine-title">Monday – Training Day Fuel</h2>
                    <div class="meal-block"><div class="meal-time-title">Meal 1: Protein Latte</div>
                        <div class="step"><div class="step-header"><div id="mon-meal-1a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 scoop Rule One Whey</div></div></div>
                        <div class="step"><div class="step-header"><div id="mon-meal-1b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 cup Unsweetened Almond Milk</div></div></div>
                    </div>
                    <div class="meal-block"><div class="meal-time-title">Meal 2: Girly Macro Bowl</div>
                        <div class="step"><div class="step-header"><div id="mon-meal-2a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">7 oz Grilled Chicken Breast</div></div></div>
                        <div class="step"><div class="step-header"><div id="mon-meal-2b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 cup Quinoa</div></div></div>
                        <div class="step"><div class="step-header"><div id="mon-meal-2c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Spinach, Tomatoes, Cucumber</div></div></div>
                    </div>
                    <div class="meal-block"><div class="meal-time-title">Meal 3: Pre-Workout Fuel</div>
                        <div class="step"><div class="step-header"><div id="mon-meal-3a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">2 Brown Rice Cakes</div></div></div>
                        <div class="step"><div class="step-header"><div id="mon-meal-3b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">2 tbsp Powdered Peanut Butter</div></div></div>
                        <div class="step"><div class="step-header"><div id="mon-meal-3c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 medium Banana</div></div></div>
                    </div>
                    <div class="meal-block"><div class="meal-time-title">Meal 4: Post-Workout Recovery</div>
                        <div class="step"><div class="step-header"><div id="mon-meal-4a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">7 oz Baked Salmon</div></div></div>
                        <div class="step"><div class="step-header"><div id="mon-meal-4b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 medium Sweet Potato</div></div></div>
                        <div class="step"><div class="step-header"><div id="mon-meal-4c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 cup Steamed Broccoli</div></div></div>
                    </div>
                    <div class="meal-block"><div class="meal-time-title">Meal 5: Evening Snack</div>
                        <div class="step"><div class="step-header"><div id="mon-meal-5a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1.5 cups Greek Yogurt</div></div></div>
                        <div class="step"><div class="step-header"><div id="mon-meal-5b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1/2 cup Mixed Berries</div></div></div>
                    </div>
                </div>
            </div>
            
            <div id="tuesday-meals" class="day-content meals">
                 <div class="meal-section"><h2 class="routine-title">Tuesday – Rest Day Fuel</h2>
                    <div class="meal-block"><div class="meal-time-title">Meal 1: Protein Latte</div>
                        <div class="step"><div class="step-header"><div id="tue-meal-1a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 scoop Rule One Whey</div></div></div>
                        <div class="step"><div class="step-header"><div id="tue-meal-1b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 cup Unsweetened Almond Milk</div></div></div>
                    </div>
                    <div class="meal-block"><div class="meal-time-title">Meal 2: Big Girly Salad</div>
                        <div class="step"><div class="step-header"><div id="tue-meal-2a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">7 oz Grilled Chicken Breast</div></div></div>
                        <div class="step"><div class="step-header"><div id="tue-meal-2b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Mixed Greens, Peppers, Onion</div></div></div>
                        <div class="step"><div class="step-header"><div id="tue-meal-2c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1/4 Avocado</div></div></div>
                    </div>
                    <div class="meal-block"><div class="meal-time-title">Meal 3: Chocolate Mousse</div>
                        <div class="step"><div class="step-header"><div id="tue-meal-3a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1.5 cups Greek Yogurt</div></div></div>
                        <div class="step"><div class="step-header"><div id="tue-meal-3b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1/2 scoop Rule One Whey</div></div></div>
                    </div>
                    <div class="meal-block"><div class="meal-time-title">Meal 4: Lean & Green Dinner</div>
                        <div class="step"><div class="step-header"><div id="tue-meal-4a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">8 oz Baked Cod</div></div></div>
                        <div class="step"><div class="step-header"><div id="tue-meal-4b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 tbsp Olive Oil</div></div></div>
                        <div class="step"><div class="step-header"><div id="tue-meal-4c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Roasted Asparagus</div></div></div>
                    </div>
                    <div class="meal-block"><div class="meal-time-title">Meal 5: Final Protein Hit</div>
                        <div class="step"><div class="step-header"><div id="tue-meal-5a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 scoop Rule One Whey Shake</div></div></div>
                    </div>
                </div>
            </div>
            
             <div id="wednesday-meals" class="day-content meals">
                <div class="meal-section"><h2 class="routine-title">Wednesday – Training Day Fuel</h2>
                    <div class="meal-block"><div class="meal-time-title">Meal 1: Protein Latte</div><div class="step"><div class="step-header"><div id="wed-meal-1a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 scoop Rule One Whey</div></div></div><div class="step"><div class="step-header"><div id="wed-meal-1b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 cup Unsweetened Almond Milk</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 2: Girly Macro Bowl</div><div class="step"><div class="step-header"><div id="wed-meal-2a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">7 oz Grilled Chicken Breast</div></div></div><div class="step"><div class="step-header"><div id="wed-meal-2b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 cup Quinoa</div></div></div><div class="step"><div class="step-header"><div id="wed-meal-2c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Spinach, Tomatoes, Cucumber</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 3: Pre-Workout Fuel</div><div class="step"><div class="step-header"><div id="wed-meal-3a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">2 Brown Rice Cakes</div></div></div><div class="step"><div class="step-header"><div id="wed-meal-3b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">2 tbsp Powdered Peanut Butter</div></div></div><div class="step"><div class="step-header"><div id="wed-meal-3c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 medium Banana</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 4: Post-Workout Recovery</div><div class="step"><div class="step-header"><div id="wed-meal-4a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">7 oz Baked Salmon</div></div></div><div class="step"><div class="step-header"><div id="wed-meal-4b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 medium Sweet Potato</div></div></div><div class="step"><div class="step-header"><div id="wed-meal-4c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 cup Steamed Broccoli</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 5: Evening Snack</div><div class="step"><div class="step-header"><div id="wed-meal-5a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1.5 cups Greek Yogurt</div></div></div><div class="step"><div class="step-header"><div id="wed-meal-5b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1/2 cup Mixed Berries</div></div></div></div>
                </div>
            </div>
            
            <div id="thursday-meals" class="day-content meals">
                <div class="meal-section"><h2 class="routine-title">Thursday – Rest Day Fuel</h2>
                    <div class="meal-block"><div class="meal-time-title">Meal 1: Protein Latte</div><div class="step"><div class="step-header"><div id="thu-meal-1a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 scoop Rule One Whey</div></div></div><div class="step"><div class="step-header"><div id="thu-meal-1b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 cup Unsweetened Almond Milk</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 2: Big Girly Salad</div><div class="step"><div class="step-header"><div id="thu-meal-2a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">7 oz Grilled Chicken Breast</div></div></div><div class="step"><div class="step-header"><div id="thu-meal-2b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Mixed Greens, Peppers, Onion</div></div></div><div class="step"><div class="step-header"><div id="thu-meal-2c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1/4 Avocado</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 3: Chocolate Mousse</div><div class="step"><div class="step-header"><div id="thu-meal-3a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1.5 cups Greek Yogurt</div></div></div><div class="step"><div class="step-header"><div id="thu-meal-3b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1/2 scoop Rule One Whey</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 4: Lean & Green Dinner</div><div class="step"><div class="step-header"><div id="thu-meal-4a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">8 oz Baked Cod</div></div></div><div class="step"><div class="step-header"><div id="thu-meal-4b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 tbsp Olive Oil</div></div></div><div class="step"><div class="step-header"><div id="thu-meal-4c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Roasted Asparagus</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 5: Final Protein Hit</div><div class="step"><div class="step-header"><div id="thu-meal-5a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 scoop Rule One Whey Shake</div></div></div></div>
                </div>
            </div>
            
            <div id="friday-meals" class="day-content meals">
                <div class="meal-section"><h2 class="routine-title">Friday – Training Day Fuel</h2>
                    <div class="meal-block"><div class="meal-time-title">Meal 1: Protein Latte</div><div class="step"><div class="step-header"><div id="fri-meal-1a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 scoop Rule One Whey</div></div></div><div class="step"><div class="step-header"><div id="fri-meal-1b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 cup Unsweetened Almond Milk</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 2: Girly Macro Bowl</div><div class="step"><div class="step-header"><div id="fri-meal-2a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">7 oz Grilled Chicken Breast</div></div></div><div class="step"><div class="step-header"><div id="fri-meal-2b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 cup Quinoa</div></div></div><div class="step"><div class="step-header"><div id="fri-meal-2c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Spinach, Tomatoes, Cucumber</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 3: Pre-Workout Fuel</div><div class="step"><div class="step-header"><div id="fri-meal-3a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">2 Brown Rice Cakes</div></div></div><div class="step"><div class="step-header"><div id="fri-meal-3b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">2 tbsp Powdered Peanut Butter</div></div></div><div class="step"><div class="step-header"><div id="fri-meal-3c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 medium Banana</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 4: Post-Workout Recovery</div><div class="step"><div class="step-header"><div id="fri-meal-4a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">7 oz Baked Salmon</div></div></div><div class="step"><div class="step-header"><div id="fri-meal-4b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 medium Sweet Potato</div></div></div><div class="step"><div class="step-header"><div id="fri-meal-4c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 cup Steamed Broccoli</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 5: Evening Snack</div><div class="step"><div class="step-header"><div id="fri-meal-5a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1.5 cups Greek Yogurt</div></div></div><div class="step"><div class="step-header"><div id="fri-meal-5b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1/2 cup Mixed Berries</div></div></div></div>
                </div>
            </div>
            
            <div id="saturday-meals" class="day-content meals">
                 <div class="meal-section"><h2 class="routine-title">Saturday – Rest Day Fuel</h2>
                    <div class="meal-block"><div class="meal-time-title">Meal 1: Protein Latte</div><div class="step"><div class="step-header"><div id="sat-meal-1a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 scoop Rule One Whey</div></div></div><div class="step"><div class="step-header"><div id="sat-meal-1b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 cup Unsweetened Almond Milk</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 2: Big Girly Salad</div><div class="step"><div class="step-header"><div id="sat-meal-2a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">7 oz Grilled Chicken Breast</div></div></div><div class="step"><div class="step-header"><div id="sat-meal-2b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Mixed Greens, Peppers, Onion</div></div></div><div class="step"><div class="step-header"><div id="sat-meal-2c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1/4 Avocado</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 3: Chocolate Mousse</div><div class="step"><div class="step-header"><div id="sat-meal-3a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1.5 cups Greek Yogurt</div></div></div><div class="step"><div class="step-header"><div id="sat-meal-3b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1/2 scoop Rule One Whey</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 4: Lean & Green Dinner</div><div class="step"><div class="step-header"><div id="sat-meal-4a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">8 oz Baked Cod</div></div></div><div class="step"><div class="step-header"><div id="sat-meal-4b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 tbsp Olive Oil</div></div></div><div class="step"><div class="step-header"><div id="sat-meal-4c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Roasted Asparagus</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 5: Final Protein Hit</div><div class="step"><div class="step-header"><div id="sat-meal-5a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 scoop Rule One Whey Shake</div></div></div></div>
                </div>
            </div>
            
            <div id="sunday-meals" class="day-content meals">
                 <div class="meal-section"><h2 class="routine-title">Sunday – Rest Day Fuel</h2>
                    <div class="meal-block"><div class="meal-time-title">Meal 1: Protein Latte</div><div class="step"><div class="step-header"><div id="sun-meal-1a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 scoop Rule One Whey</div></div></div><div class="step"><div class="step-header"><div id="sun-meal-1b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 cup Unsweetened Almond Milk</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 2: Big Girly Salad</div><div class="step"><div class="step-header"><div id="sun-meal-2a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">7 oz Grilled Chicken Breast</div></div></div><div class="step"><div class="step-header"><div id="sun-meal-2b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Mixed Greens, Peppers, Onion</div></div></div><div class="step"><div class="step-header"><div id="sun-meal-2c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1/4 Avocado</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 3: Chocolate Mousse</div><div class="step"><div class="step-header"><div id="sun-meal-3a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1.5 cups Greek Yogurt</div></div></div><div class="step"><div class="step-header"><div id="sun-meal-3b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1/2 scoop Rule One Whey</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 4: Lean & Green Dinner</div><div class="step"><div class="step-header"><div id="sun-meal-4a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">8 oz Baked Cod</div></div></div><div class="step"><div class="step-header"><div id="sun-meal-4b" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 tbsp Olive Oil</div></div></div><div class="step"><div class="step-header"><div id="sun-meal-4c" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">Roasted Asparagus</div></div></div></div>
                    <div class="meal-block"><div class="meal-time-title">Meal 5: Final Protein Hit</div><div class="step"><div class="step-header"><div id="sun-meal-5a" class="step-checkbox" onclick="toggleCheckbox(this)"></div><div class="step-title">1 scoop Rule One Whey Shake</div></div></div></div>
                </div>
            </div>
        </div>

        <div id="history-toggle-section">
             <input type="date" id="history-date-input">
             <button id="load-history-btn" class="history-btn">Load History</button>
             <button id="history-toggle-btn" class="history-btn">📊 Show History</button>
        </div>
        <div id="history-display-section" class="hidden">
             <h3 id="history-display-title">Progress History</h3>
             <div id="history-skincare-summary"></div>
             <div id="history-workout-summary"></div>
             <div id="history-meals-summary"></div>
             <p id="history-no-data" class="hidden" style="text-align: center; color: #6b7280; font-style: italic;">No data found for selected date.</p>
        </div>

        <div class="notice">
            Progress automatically saves and resets at midnight.
        </div>

    </div>
    <script>
        // --- Global Error Handler ---
        window.onerror = function(message, source, lineno, colno, error) {
            console.error("Uncaught Error:", message, "\nSource:", source, "\nLine:", lineno, "Col:", colno, "\nError Obj:", error);
            return true; 
        };

        // --- Constants & Initial State ---
        const today = new Date();
        const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const dayOfWeek = today.getDay();
        const treatmentSchedule = { 0: 'slugging', 1: 'retinoid', 2: 'exfoliant', 3: 'retinoid', 4: 'exfoliant', 5: 'retinoid', 6: 'slugging' };
        const workoutSchedule = { 0: 'Rest & Prep', 1: 'Workout A', 2: 'Cardio/Corrective', 3: 'Workout B', 4: 'Cardio/Corrective', 5: 'Workout C', 6: 'Recovery' };
        const todaysRecommendedTreatment = treatmentSchedule[dayOfWeek];
        const todaysRecommendedWorkout = workoutSchedule[dayOfWeek];

        let currentSection = 'skincare';
        let currentRoutine = 'morning';
        let currentTreatment = todaysRecommendedTreatment;
        let currentWorkoutDay = dayNames[dayOfWeek].toLowerCase();
        let currentMealsDay = dayNames[dayOfWeek].toLowerCase();
        let completedSteps = {};
        let workoutLocations = { monday: 'gym', wednesday: 'gym', friday: 'gym' };

        const STORAGE_KEYS = {
            CURRENT_STATE: 'girly-tracker-current-state',
            DAILY_SUMMARY_PREFIX: 'girly-tracker-summary-',
        };

        // --- Utility Functions ---
        function getLocalDateString(date = new Date()) {
            return date.toISOString().split('T')[0];
        }

        function saveToStorage(key, data) {
            try { localStorage.setItem(key, JSON.stringify(data)); } catch (e) { console.warn(`LocalStorage save error:`, e); }
        }

        function loadFromStorage(key) {
            try { const data = localStorage.getItem(key); return data ? JSON.parse(data) : null; } catch (e) { console.warn(`LocalStorage load error:`, e); return null; }
        }

        // --- State Management ---
        function saveCurrentState() {
            const stateToSave = {
                lastSavedDate: getLocalDateString(),
                completedSteps, currentSection, currentRoutine, currentTreatment,
                currentWorkoutDay, currentMealsDay, workoutLocations
            };
            saveToStorage(STORAGE_KEYS.CURRENT_STATE, stateToSave);
        }

        function loadCurrentState() {
            const loadedState = loadFromStorage(STORAGE_KEYS.CURRENT_STATE);
            const todayStr = getLocalDateString();
            const defaultLocations = { monday: 'gym', wednesday: 'gym', friday: 'gym' };

            if (loadedState && loadedState.lastSavedDate === todayStr) {
                completedSteps = loadedState.completedSteps || {};
                currentSection = loadedState.currentSection || 'skincare';
                currentRoutine = loadedState.currentRoutine || 'morning';
                currentTreatment = loadedState.currentTreatment || todaysRecommendedTreatment;
                currentWorkoutDay = loadedState.currentWorkoutDay || dayNames[dayOfWeek].toLowerCase();
                currentMealsDay = loadedState.currentMealsDay || dayNames[dayOfWeek].toLowerCase();
                workoutLocations = { ...defaultLocations, ...(loadedState.workoutLocations || {}) };
            } else {
                completedSteps = {};
                workoutLocations = defaultLocations;
                saveCurrentState(); // Save fresh default state for today
            }
        }
        
        // --- Checkbox & Progress ---
        function toggleCheckbox(element) {
            const stepId = element.id;
            const isChecked = element.classList.toggle('checked');
            element.innerHTML = isChecked ? '✓' : '';
            if (isChecked) completedSteps[stepId] = true;
            else delete completedSteps[stepId];
            updateProgress();
            saveCurrentState();
        }

        function updateProgress() {
            let relevantStepIds = [];
            if (currentSection === 'skincare') {
                if (currentRoutine === 'morning') {
                    relevantStepIds = ['morning-cleanse', 'morning-vitaminc', 'morning-moisturize', 'morning-sunscreen'];
                } else {
                    relevantStepIds = ['evening-cleanse', 'evening-hydration', 'evening-moisturize'];
                    if (currentTreatment === 'retinoid') relevantStepIds.push('evening-treatment-retinoid');
                    else if (currentTreatment === 'exfoliant') relevantStepIds.push('evening-treatment-exfoliant');
                    else if (currentTreatment === 'slugging') relevantStepIds.push('evening-treatment-slugging', 'evening-slugging');
                }
            } else if (currentSection === 'workout') {
                const workoutContainer = document.getElementById(`${currentWorkoutDay}-workout`);
                if (workoutContainer) {
                    const activeCheckboxes = Array.from(workoutContainer.querySelectorAll('.step-checkbox')).filter(box => {
                        const parentBlock = box.closest('.exercise-block');
                        return !parentBlock || parentBlock.classList.contains('active');
                    });
                    relevantStepIds = activeCheckboxes.map(el => el.id);
                }
            } else if (currentSection === 'meals') {
                const mealsContainer = document.getElementById(`${currentMealsDay}-meals`);
                if (mealsContainer) {
                    relevantStepIds = Array.from(mealsContainer.querySelectorAll('.step-checkbox')).map(el => el.id);
                }
            }

            const totalSteps = relevantStepIds.length;
            const completedCount = relevantStepIds.filter(stepId => completedSteps[stepId]).length;
            const progressPercentage = totalSteps > 0 ? Math.round((completedCount / totalSteps) * 100) : 0;
            document.getElementById('progress-percentage').textContent = `${progressPercentage}%`;
            document.getElementById('progress-bar').style.width = `${progressPercentage}%`;
        }
        
        // --- UI Switching ---
        function switchMainTab(section) {
            document.querySelectorAll('.main-tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(`${section}-main-tab`)?.classList.add('active');
            document.querySelectorAll('.section-content').forEach(sec => sec.classList.remove('active'));
            document.getElementById(`${section}-section`)?.classList.add('active');
            currentSection = section;

            if (section === 'skincare') switchRoutine(currentRoutine);
            else if (section === 'workout') setActiveDay(currentWorkoutDay, 'workout');
            else if (section === 'meals') setActiveDay(currentMealsDay, 'meals');

            updateProgress();
            saveCurrentState();
        }

        function switchRoutine(routine) {
            document.getElementById('morning-tab').className = `tab ${routine === 'morning' ? 'active-morning' : 'inactive'}`;
            document.getElementById('evening-tab').className = `tab ${routine === 'evening' ? 'active-evening' : 'inactive'}`;
            document.getElementById('morning-routine').classList.toggle('hidden', routine !== 'morning');
            document.getElementById('evening-routine').classList.toggle('hidden', routine !== 'evening');
            currentRoutine = routine;
            if (routine === 'evening') selectTreatment(currentTreatment); // Ensure correct treatment view
            updateProgress();
            saveCurrentState();
        }

        function setActiveDay(dayName, type) {
            const dayTabs = document.querySelectorAll(`#${type}-section .day-tab`);
            dayTabs.forEach(tab => tab.classList.remove('active'));
            document.getElementById(`${dayName}-${type}-tab`)?.classList.add('active');
            
            const dayContents = document.querySelectorAll(`.${type}.day-content`);
            dayContents.forEach(content => content.classList.remove('active'));
            document.getElementById(`${dayName}-${type}`)?.classList.add('active');

            if (type === 'workout') {
                currentWorkoutDay = dayName;
                updateLocationToggleUI(dayName, workoutLocations[dayName]);
            } else if (type === 'meals') {
                currentMealsDay = dayName;
            }
            updateProgress();
            saveCurrentState();
        }

        function selectTreatment(treatment) {
            currentTreatment = treatment;
            document.querySelectorAll('.treatment-btn').forEach(btn => btn.classList.toggle('active', btn.id === `${treatment}-btn`));
            document.getElementById('retinoid-step').classList.toggle('hidden', treatment !== 'retinoid');
            document.getElementById('exfoliant-step').classList.toggle('hidden', treatment !== 'exfoliant');
            document.getElementById('slugging-step').classList.toggle('hidden', treatment !== 'slugging');
            document.getElementById('evening-slug').classList.toggle('hidden', treatment !== 'slugging');
            updateProgress();
            saveCurrentState();
        }
        
        function switchWorkoutLocation(dayName, location) {
            workoutLocations[dayName] = location;
            updateLocationToggleUI(dayName, location);
            updateProgress();
            saveCurrentState();
        }

        function updateLocationToggleUI(dayName, location) {
            const dayContainer = document.getElementById(`${dayName}-workout`);
            if (!dayContainer) return;

            dayContainer.querySelector(`#${dayName}-toggle-gym`)?.classList.toggle('active', location === 'gym');
            dayContainer.querySelector(`#${dayName}-toggle-home`)?.classList.toggle('active', location === 'home');
            dayContainer.querySelector(`#${dayName}-gym-exercises`)?.classList.toggle('hidden', location !== 'gym');
            dayContainer.querySelector(`#${dayName}-gym-exercises`)?.classList.toggle('active', location === 'gym');
            dayContainer.querySelector(`#${dayName}-home-exercises`)?.classList.toggle('hidden', location !== 'home');
            dayContainer.querySelector(`#${dayName}-home-exercises`)?.classList.toggle('active', location === 'home');
        }

        // --- Initialization ---
        function setupUI() {
            // Restore checkbox visuals
            Object.keys(completedSteps).forEach(stepId => {
                const checkbox = document.getElementById(stepId);
                if (checkbox && completedSteps[stepId]) {
                    checkbox.classList.add('checked');
                    checkbox.innerHTML = '✓';
                }
            });

            // Set up header
            document.getElementById('current-date').textContent = today.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' });
            document.getElementById('today-recommendation').innerHTML = `Today: <b>${dayNames[dayOfWeek]} (${todaysRecommendedWorkout})</b> — Skincare: <b>${todaysRecommendedTreatment.charAt(0).toUpperCase() + todaysRecommendedTreatment.slice(1)}</b>`;
            document.getElementById(`${todaysRecommendedTreatment}-schedule`)?.classList.add('highlighted');
            
            // Set initial active views
            switchMainTab(currentSection);
        }

        function attachEventListeners() {
            document.getElementById('skincare-main-tab')?.addEventListener('click', () => switchMainTab('skincare'));
            document.getElementById('workout-main-tab')?.addEventListener('click', () => switchMainTab('workout'));
            document.getElementById('meals-main-tab')?.addEventListener('click', () => switchMainTab('meals'));
            
            document.getElementById('morning-tab')?.addEventListener('click', () => switchRoutine('morning'));
            document.getElementById('evening-tab')?.addEventListener('click', () => switchRoutine('evening'));
            
            document.getElementById('retinoid-btn')?.addEventListener('click', () => selectTreatment('retinoid'));
            document.getElementById('exfoliant-btn')?.addEventListener('click', () => selectTreatment('exfoliant'));
            document.getElementById('slugging-btn')?.addEventListener('click', () => selectTreatment('slugging'));

            dayNames.forEach(day => {
                const dayLower = day.toLowerCase();
                document.getElementById(`${dayLower}-workout-tab`)?.addEventListener('click', () => setActiveDay(dayLower, 'workout'));
                document.getElementById(`${dayLower}-meals-tab`)?.addEventListener('click', () => setActiveDay(dayLower, 'meals'));
            });

            const daysWithToggles = ['monday', 'wednesday', 'friday'];
            daysWithToggles.forEach(day => {
                 document.getElementById(`${day}-toggle-gym`)?.addEventListener('click', () => switchWorkoutLocation(day, 'gym'));
                 document.getElementById(`${day}-toggle-home`)?.addEventListener('click', () => switchWorkoutLocation(day, 'home'));
            });

            window.addEventListener('beforeunload', () => saveCurrentState());
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadCurrentState();
            setupUI();
            attachEventListeners();
        });
    </script>
</body>
</html>
